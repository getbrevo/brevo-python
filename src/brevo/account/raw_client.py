# This file was auto-generated by Fern from our API Definition.

import typing
from json.decoder import JSONDecodeError

from ..core.api_error import ApiError
from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.http_response import AsyncHttpResponse, HttpResponse
from ..core.request_options import RequestOptions
from ..core.unchecked_base_model import construct_type
from ..errors.bad_request_error import BadRequestError
from .types.get_account_activity_response import GetAccountActivityResponse
from .types.get_account_response import GetAccountResponse


class RawAccountClient:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._client_wrapper = client_wrapper

    def get_account(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> HttpResponse[GetAccountResponse]:
        """
        Retrieves details of your Brevo account.

        **Use this to:**
        - Get account information (email, name, company, address)
        - Check plan details (type, credits, expiration)
        - Get relay information (for transactional emails)
        - Check Marketing Automation status
        - View date/time preferences and account settings
        - Access organization and user identifiers

        **Key information returned:**
        - Complete account details (organization ID, user ID, company information)
        - Address and contact information
        - Plan configurations and credit allocations across different verticals
        - Marketing Automation settings and tracker key
        - SMTP relay configuration for transactional emails
        - Date/time preferences and account settings
        - Enterprise features availability status

        **Important considerations:**
        - Provides comprehensive account overview for billing and configuration management
        - Essential for understanding current plan limitations and feature availability
        - Marketing Automation key required for advanced automation features
        - Plan verticals show detailed breakdown across Marketing, Chat, and CRM categories
        - Relay configuration crucial for transactional email setup and deliverability
        - Date/time preferences affect campaign scheduling and reporting displays
        - Enterprise status determines access to advanced features and sub-account management

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        HttpResponse[GetAccountResponse]
            Account information retrieved successfully
        """
        _response = self._client_wrapper.httpx_client.request(
            "account",
            method="GET",
            request_options=request_options,
        )
        try:
            if 200 <= _response.status_code < 300:
                _data = typing.cast(
                    GetAccountResponse,
                    construct_type(
                        type_=GetAccountResponse,  # type: ignore
                        object_=_response.json(),
                    ),
                )
                return HttpResponse(response=_response, data=_data)
            _response_json = _response.json()
        except JSONDecodeError:
            raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response.text)
        raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)

    def get_account_activity(
        self,
        *,
        start_date: typing.Optional[str] = None,
        end_date: typing.Optional[str] = None,
        email: typing.Optional[str] = None,
        limit: typing.Optional[int] = None,
        offset: typing.Optional[int] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> HttpResponse[GetAccountActivityResponse]:
        """
        Retrieves user activity logs from your organization for security monitoring and audit compliance.

        Use this to:
        - Monitor user login activities and access patterns
        - Track account modifications and configuration changes
        - Generate security audit reports and compliance documentation
        - Investigate suspicious activities and unauthorized access
        - Monitor team member actions and account usage

        Key information returned:
        - Complete user activity details and timestamps
        - User identification (email, IP address, browser)
        - Action types and activity descriptions
        - Security-relevant events and access logs
        - Historical activity data for audit trails

        Note: Requires Enterprise plan for access to organization activity logs.

        Parameters
        ----------
        start_date : typing.Optional[str]
            Mandatory if endDate is used. Enter start date in UTC date (YYYY-MM-DD)
            format to filter the activity in your account. Maximum time period that
            can be selected is one month. Additionally, you can retrieve activity
            logs from the past 12 months from the date of your search.

        end_date : typing.Optional[str]
            Mandatory if startDate is used. Enter end date in UTC date (YYYY-MM-DD)
            format to filter the activity in your account. Maximum time period that
            can be selected is one month.

        email : typing.Optional[str]
            Enter the user's email address to filter their activity in the account.

        limit : typing.Optional[int]
            Number of documents per page

        offset : typing.Optional[int]
            Index of the first document in the page.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        HttpResponse[GetAccountActivityResponse]
            list of user activity logs
        """
        _response = self._client_wrapper.httpx_client.request(
            "organization/activities",
            method="GET",
            params={
                "startDate": start_date,
                "endDate": end_date,
                "email": email,
                "limit": limit,
                "offset": offset,
            },
            request_options=request_options,
        )
        try:
            if 200 <= _response.status_code < 300:
                _data = typing.cast(
                    GetAccountActivityResponse,
                    construct_type(
                        type_=GetAccountActivityResponse,  # type: ignore
                        object_=_response.json(),
                    ),
                )
                return HttpResponse(response=_response, data=_data)
            if _response.status_code == 400:
                raise BadRequestError(
                    headers=dict(_response.headers),
                    body=typing.cast(
                        typing.Any,
                        construct_type(
                            type_=typing.Any,  # type: ignore
                            object_=_response.json(),
                        ),
                    ),
                )
            _response_json = _response.json()
        except JSONDecodeError:
            raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response.text)
        raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)


class AsyncRawAccountClient:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._client_wrapper = client_wrapper

    async def get_account(
        self, *, request_options: typing.Optional[RequestOptions] = None
    ) -> AsyncHttpResponse[GetAccountResponse]:
        """
        Retrieves details of your Brevo account.

        **Use this to:**
        - Get account information (email, name, company, address)
        - Check plan details (type, credits, expiration)
        - Get relay information (for transactional emails)
        - Check Marketing Automation status
        - View date/time preferences and account settings
        - Access organization and user identifiers

        **Key information returned:**
        - Complete account details (organization ID, user ID, company information)
        - Address and contact information
        - Plan configurations and credit allocations across different verticals
        - Marketing Automation settings and tracker key
        - SMTP relay configuration for transactional emails
        - Date/time preferences and account settings
        - Enterprise features availability status

        **Important considerations:**
        - Provides comprehensive account overview for billing and configuration management
        - Essential for understanding current plan limitations and feature availability
        - Marketing Automation key required for advanced automation features
        - Plan verticals show detailed breakdown across Marketing, Chat, and CRM categories
        - Relay configuration crucial for transactional email setup and deliverability
        - Date/time preferences affect campaign scheduling and reporting displays
        - Enterprise status determines access to advanced features and sub-account management

        Parameters
        ----------
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        AsyncHttpResponse[GetAccountResponse]
            Account information retrieved successfully
        """
        _response = await self._client_wrapper.httpx_client.request(
            "account",
            method="GET",
            request_options=request_options,
        )
        try:
            if 200 <= _response.status_code < 300:
                _data = typing.cast(
                    GetAccountResponse,
                    construct_type(
                        type_=GetAccountResponse,  # type: ignore
                        object_=_response.json(),
                    ),
                )
                return AsyncHttpResponse(response=_response, data=_data)
            _response_json = _response.json()
        except JSONDecodeError:
            raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response.text)
        raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)

    async def get_account_activity(
        self,
        *,
        start_date: typing.Optional[str] = None,
        end_date: typing.Optional[str] = None,
        email: typing.Optional[str] = None,
        limit: typing.Optional[int] = None,
        offset: typing.Optional[int] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> AsyncHttpResponse[GetAccountActivityResponse]:
        """
        Retrieves user activity logs from your organization for security monitoring and audit compliance.

        Use this to:
        - Monitor user login activities and access patterns
        - Track account modifications and configuration changes
        - Generate security audit reports and compliance documentation
        - Investigate suspicious activities and unauthorized access
        - Monitor team member actions and account usage

        Key information returned:
        - Complete user activity details and timestamps
        - User identification (email, IP address, browser)
        - Action types and activity descriptions
        - Security-relevant events and access logs
        - Historical activity data for audit trails

        Note: Requires Enterprise plan for access to organization activity logs.

        Parameters
        ----------
        start_date : typing.Optional[str]
            Mandatory if endDate is used. Enter start date in UTC date (YYYY-MM-DD)
            format to filter the activity in your account. Maximum time period that
            can be selected is one month. Additionally, you can retrieve activity
            logs from the past 12 months from the date of your search.

        end_date : typing.Optional[str]
            Mandatory if startDate is used. Enter end date in UTC date (YYYY-MM-DD)
            format to filter the activity in your account. Maximum time period that
            can be selected is one month.

        email : typing.Optional[str]
            Enter the user's email address to filter their activity in the account.

        limit : typing.Optional[int]
            Number of documents per page

        offset : typing.Optional[int]
            Index of the first document in the page.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        AsyncHttpResponse[GetAccountActivityResponse]
            list of user activity logs
        """
        _response = await self._client_wrapper.httpx_client.request(
            "organization/activities",
            method="GET",
            params={
                "startDate": start_date,
                "endDate": end_date,
                "email": email,
                "limit": limit,
                "offset": offset,
            },
            request_options=request_options,
        )
        try:
            if 200 <= _response.status_code < 300:
                _data = typing.cast(
                    GetAccountActivityResponse,
                    construct_type(
                        type_=GetAccountActivityResponse,  # type: ignore
                        object_=_response.json(),
                    ),
                )
                return AsyncHttpResponse(response=_response, data=_data)
            if _response.status_code == 400:
                raise BadRequestError(
                    headers=dict(_response.headers),
                    body=typing.cast(
                        typing.Any,
                        construct_type(
                            type_=typing.Any,  # type: ignore
                            object_=_response.json(),
                        ),
                    ),
                )
            _response_json = _response.json()
        except JSONDecodeError:
            raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response.text)
        raise ApiError(status_code=_response.status_code, headers=dict(_response.headers), body=_response_json)
